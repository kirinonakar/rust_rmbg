import { VerticalBox, Button, CheckBox, ProgressIndicator } from "std-widgets.slint";

export component MainWindow inherits Window {
    width: 600px;
    height: 600px;
    title: "Background Removal Tool";
    icon: @image-url("../app.ico");

    callback files_dropped(string);
    in property <string> status_text: "Drag and Drop PNG here";
    in property <image> preview_image;
    in property <bool> has_image: false;
    in-out property <bool> save_32bit_bmp: false;
    
    in property <bool> is_processing: false;
    in property <float> progress: 0.0;

    // A drop area to capture file drops natively, if supported by the Slint backend.
    // In many winit backends, dropping a file on the window will issue a WindowEvent.
    // We handle it in Rust.

    VerticalBox {
        Text {
            text: root.status_text;
            horizontal-alignment: center;
            font-size: 16px;
        }

        if (root.is_processing) : ProgressIndicator {
            progress: root.progress;
        }

        if (root.has_image) : Image {
            source: root.preview_image;
            width: 400px;
            height: 400px;
            image-fit: contain;
        }

        Rectangle {} // Spacer

        CheckBox {
            text: "Add 32bit bmp with alpha channel";
            checked: root.save_32bit_bmp;
            toggled => {
                root.save_32bit_bmp = self.checked;
            }
        }

        Button {
            text: "Select Image";
            enabled: !root.is_processing;
            clicked => {
                root.files-dropped("");
            }
        }
    }
}
